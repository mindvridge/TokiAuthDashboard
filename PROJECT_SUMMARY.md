# Toki Auth Dashboard - í”„ë¡œì íŠ¸ ìš”ì•½

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**Toki Auth Dashboard**ëŠ” Toki Auth Serviceì˜ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤. Streamlitìœ¼ë¡œ êµ¬ì¶•ë˜ì—ˆìœ¼ë©°, REST APIë¥¼ í†µí•´ ì‚¬ìš©ì ì •ë³´ì™€ í†µê³„ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

## ğŸ— ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Toki Auth Dashboard (Streamlit)    â”‚
â”‚  - ì‚¬ìš©ì ê´€ë¦¬                       â”‚
â”‚  - í†µê³„ ë° ì°¨íŠ¸                      â”‚
â”‚  - OAuth ê³„ì • ê´€ë¦¬                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ REST API (JWT ì¸ì¦)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Toki Auth Service (FastAPI)        â”‚
â”‚  - Admin API ì œê³µ                    â”‚
â”‚  - JWT í† í° ê²€ì¦                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Database Query
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL / SQLite                â”‚
â”‚  - ì‚¬ìš©ì ë°ì´í„°                     â”‚
â”‚  - OAuth ì—°ë™ ì •ë³´                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
TokiAuthDashboard/
â”œâ”€â”€ app.py                      # ë©”ì¸ í˜ì´ì§€ (ëŒ€ì‹œë³´ë“œ í™ˆ)
â”œâ”€â”€ requirements.txt            # Python íŒ¨í‚¤ì§€
â”œâ”€â”€ Dockerfile                  # Docker ì´ë¯¸ì§€ ë¹Œë“œ
â”œâ”€â”€ deploy.sh                   # ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ env.example                 # í™˜ê²½ ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ .gitignore                  # Git ì œì™¸ íŒŒì¼
â”‚
â”œâ”€â”€ components/                 # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ sidebar.py              # ë¡œê·¸ì¸ ë° ë„¤ë¹„ê²Œì´ì…˜
â”‚
â”œâ”€â”€ utils/                      # ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ auth.py                # ì¸ì¦ ë° API í˜¸ì¶œ
â”‚
â”œâ”€â”€ pages/                      # ë©€í‹°í˜ì´ì§€
â”‚   â”œâ”€â”€ 1_ğŸ‘¥_Users.py          # ì‚¬ìš©ì ëª©ë¡
â”‚   â”œâ”€â”€ 2_ğŸ“Š_Statistics.py     # í†µê³„
â”‚   â”œâ”€â”€ 3_ğŸ”—_OAuth.py          # OAuth ê³„ì •
â”‚   â””â”€â”€ 4_âš™ï¸_Settings.py       # ì„¤ì •
â”‚
â”œâ”€â”€ .streamlit/                 # Streamlit ì„¤ì •
â”‚   â”œâ”€â”€ config.toml
â”‚   â””â”€â”€ secrets.toml.example
â”‚
â”œâ”€â”€ README.md                   # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”œâ”€â”€ QUICKSTART.md               # ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
â””â”€â”€ PROJECT_SUMMARY.md          # ì´ íŒŒì¼
```

## ğŸ”‘ ì£¼ìš” ê¸°ëŠ¥

### 1. ëŒ€ì‹œë³´ë“œ í™ˆ
- ì£¼ìš” í†µê³„ ì§€í‘œ (ì „ì²´/í™œì„± ì‚¬ìš©ì, ì˜¤ëŠ˜ ê°€ì…ì ë“±)
- OAuth ì œê³µìë³„ ë¶„í¬ ì°¨íŠ¸ (íŒŒì´ì°¨íŠ¸, ë°”ì°¨íŠ¸)
- ìµœê·¼ 30ì¼ ê°€ì…ì ì¶”ì´ ê·¸ë˜í”„
- ìµœê·¼ ê°€ì… ì‚¬ìš©ì ëª©ë¡

### 2. ì‚¬ìš©ì ê´€ë¦¬
- ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
- ì´ë©”ì¼/ì´ë¦„ ê²€ìƒ‰
- í™œì„±í™” ìƒíƒœ í•„í„°ë§
- í˜ì´ì§€ë„¤ì´ì…˜
- ì‚¬ìš©ì ìƒì„¸ ì •ë³´ ì¡°íšŒ
- CSV ë‚´ë³´ë‚´ê¸°

### 3. í†µê³„
- í™œì„±/ë¹„í™œì„± ì‚¬ìš©ì íŒŒì´ì°¨íŠ¸
- í™œì„± ì‚¬ìš©ì ë¹„ìœ¨ ê²Œì´ì§€
- OAuth ì œê³µìë³„ í†µê³„
- ì¼ë³„ ê°€ì…ì ì¶”ì´ (ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥)
- ëˆ„ì  ê°€ì…ì ê·¸ë˜í”„

### 4. OAuth ê³„ì • ê´€ë¦¬
- OAuth ì—°ë™ ê³„ì • ëª©ë¡
- ì œê³µìë³„ í•„í„°ë§
- ì—°ë™ ê³„ì • í†µê³„
- CSV ë‚´ë³´ë‚´ê¸°

### 5. ì„¤ì •
- ê³„ì • ì •ë³´ í‘œì‹œ
- API ì—°ê²° ìƒíƒœ í™•ì¸
- í† í° ì •ë³´ ë° ìœ íš¨ì„± í™•ì¸
- ë¡œê·¸ì•„ì›ƒ

## ğŸ” ì¸ì¦ ë°©ì‹

### JWT í† í° ê¸°ë°˜ ì¸ì¦

1. **ì‚¬ìš©ìê°€ Toki Auth Serviceì—ì„œ ë¡œê·¸ì¸**
   - ì¹´ì¹´ì˜¤ ë˜ëŠ” êµ¬ê¸€ OAuth ì‚¬ìš©
   - JWT í† í° ë°œê¸‰ë°›ìŒ

2. **ëŒ€ì‹œë³´ë“œì—ì„œ í† í° ì…ë ¥**
   - ì‚¬ì´ë“œë°”ì—ì„œ access_tokenê³¼ refresh_token ì…ë ¥
   - ì„¸ì…˜ì— ì €ì¥

3. **API ìš”ì²­ ì‹œ í† í° ìë™ í¬í•¨**
   - ëª¨ë“  API ìš”ì²­ì— `Authorization: Bearer {token}` í—¤ë” ì¶”ê°€
   - 401 ì—ëŸ¬ ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ

## ğŸ“¡ ì‚¬ìš©í•˜ëŠ” API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ API
- `GET /api/v1/auth/me` - í˜„ì¬ ì‚¬ìš©ì ì •ë³´ (í† í° ê²€ì¦)

### ê´€ë¦¬ì API
- `GET /api/v1/admin/users` - ì‚¬ìš©ì ëª©ë¡
- `GET /api/v1/admin/users/{id}` - ì‚¬ìš©ì ìƒì„¸
- `GET /api/v1/admin/stats` - ì „ì²´ í†µê³„
- `GET /api/v1/admin/stats/daily` - ì¼ë³„ í†µê³„
- `GET /api/v1/admin/stats/providers` - ì œê³µìë³„ í†µê³„
- `GET /api/v1/admin/oauth-accounts` - OAuth ê³„ì • ëª©ë¡
- `GET /api/v1/admin/health` - í—¬ìŠ¤ ì²´í¬

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

- **Streamlit 1.29.0**: ì›¹ í”„ë ˆì„ì›Œí¬
- **Plotly**: ì¸í„°ë™í‹°ë¸Œ ì°¨íŠ¸
- **Pandas**: ë°ì´í„° ì²˜ë¦¬
- **Requests**: HTTP í´ë¼ì´ì–¸íŠ¸

## â˜ï¸ ë°°í¬ ì •ë³´

### ë°°í¬ ëŒ€ìƒ
- **í”Œë«í¼**: Google Cloud Run
- **í”„ë¡œì íŠ¸**: keyboardai-473202
- **ì„œë¹„ìŠ¤ëª…**: toki-auth-dashboard
- **ë¦¬ì „**: asia-northeast3 (ì„œìš¸)

### ë°°í¬ ë°©ë²•
```powershell
# Docker ë¹Œë“œ ë° ë°°í¬
gcloud builds submit --tag gcr.io/keyboardai-473202/toki-auth-dashboard

# Cloud Run ë°°í¬
gcloud run deploy toki-auth-dashboard \
  --image gcr.io/keyboardai-473202/toki-auth-dashboard:latest \
  --region asia-northeast3 \
  --platform managed \
  --memory 512Mi \
  --cpu 1 \
  --no-allow-unauthenticated \
  --set-env-vars "API_BASE_URL=https://toki-auth-964943834069.asia-northeast3.run.app"
```

### ë³´ì•ˆ ì„¤ì •
```powershell
# íŠ¹ì • ì‚¬ìš©ìì—ê²Œë§Œ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬
gcloud run services add-iam-policy-binding toki-auth-dashboard \
  --region asia-northeast3 \
  --member="user:your-email@gmail.com" \
  --role="roles/run.invoker"
```

## ğŸ¯ ì£¼ìš” ì°¨ì´ì : Toki Auth vs Dashboard

| í•­ëª© | Toki Auth Service | Toki Auth Dashboard |
|------|------------------|---------------------|
| **ëª©ì ** | ì¸ì¦ ì„œë¹„ìŠ¤ | ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ |
| **í”„ë ˆì„ì›Œí¬** | FastAPI | Streamlit |
| **ì ‘ê·¼ ê¶Œí•œ** | ê³µê°œ (ì•ˆë“œë¡œì´ë“œ ì•±) | ì œí•œ (ê´€ë¦¬ìë§Œ) |
| **ì£¼ìš” ê¸°ëŠ¥** | OAuth ë¡œê·¸ì¸, JWT ë°œê¸‰ | ì‚¬ìš©ì ì¡°íšŒ, í†µê³„ |
| **ë°ì´í„° ì ‘ê·¼** | ì§ì ‘ DB ì ‘ê·¼ | REST API í˜¸ì¶œ |
| **ë°°í¬ ë°©ì‹** | `--allow-unauthenticated` | `--no-allow-unauthenticated` |

## ğŸ“Š ì£¼ìš” í™”ë©´

### ëŒ€ì‹œë³´ë“œ í™ˆ
- ì£¼ìš” ì§€í‘œ ì¹´ë“œ (4ê°œ)
- OAuth ì œê³µì íŒŒì´ì°¨íŠ¸
- ì¼ë³„ ê°€ì…ì ë¼ì¸ì°¨íŠ¸
- ìµœê·¼ ê°€ì…ì í…Œì´ë¸”

### ì‚¬ìš©ì ê´€ë¦¬
- ê²€ìƒ‰ ë° í•„í„°
- í˜ì´ì§€ë„¤ì´ì…˜
- ì‚¬ìš©ì ìƒì„¸ ì •ë³´
- CSV ë‹¤ìš´ë¡œë“œ

### í†µê³„
- í™œì„±/ë¹„í™œì„± íŒŒì´ì°¨íŠ¸
- í™œì„±ë¥  ê²Œì´ì§€
- ì œê³µìë³„ ë°”ì°¨íŠ¸
- ì¼ë³„ ì¶”ì´ ë¼ì¸/ì˜ì—­ ì°¨íŠ¸

## ğŸ”§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ì°¨íŠ¸ ìƒ‰ìƒ ë³€ê²½
```python
# app.pyì—ì„œ color_discrete_map ìˆ˜ì •
color_discrete_map={
    "ì¹´ì¹´ì˜¤": "#FEE500",  # ë…¸ë€ìƒ‰
    "êµ¬ê¸€": "#4285F4"     # íŒŒë€ìƒ‰
}
```

### í†µê³„ ê¸°ê°„ ë³€ê²½
```python
# pages/2_ğŸ“Š_Statistics.py
days_range = st.slider("ì¡°íšŒ ê¸°ê°„ (ì¼)", 7, 90, 30)
```

## ğŸ’¡ ìœ ìš©í•œ ëª…ë ¹ì–´

```powershell
# ë¡œì»¬ ì‹¤í–‰
streamlit run app.py

# í¬íŠ¸ ë³€ê²½
streamlit run app.py --server.port 8502

# ë””ë²„ê·¸ ëª¨ë“œ
streamlit run app.py --logger.level=debug

# ìë™ ìƒˆë¡œê³ ì¹¨ í™œì„±í™”
streamlit run app.py --server.runOnSave=true
```

## ğŸ“ ê°œë°œ íŒ

1. **ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”**: ì‚¬ì´ë“œë°”ì—ì„œ "Clear cache" í´ë¦­
2. **API ì‘ë‹µ í™•ì¸**: ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ â†’ Network íƒ­
3. **ì—ëŸ¬ ì¶”ì **: Streamlit ë¡œê·¸ í™•ì¸

---

**Toki Auth Dashboard** - ê°„í¸í•˜ê³  ì§ê´€ì ì¸ ì‚¬ìš©ì ê´€ë¦¬ ì†”ë£¨ì…˜

